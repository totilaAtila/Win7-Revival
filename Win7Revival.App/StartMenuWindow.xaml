<Window
    x:Class="Win7Revival.App.StartMenuWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Win7 Start Menu">

    <Grid x:Name="RootGrid" Background="#E6202020">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ROW 0: User Banner -->
        <Grid Grid.Row="0" Padding="12,14" Background="#40FFFFFF">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <FontIcon Glyph="&#xE77B;" FontSize="40" Foreground="#AAFFFFFF"/>
                <StackPanel VerticalAlignment="Center">
                    <TextBlock x:Name="UserNameText" Text="User" FontSize="16" FontWeight="SemiBold"
                               Foreground="White"/>
                    <TextBlock x:Name="UserRoleText" Text="" FontSize="11" Foreground="#99FFFFFF"/>
                </StackPanel>
            </StackPanel>
        </Grid>

        <!-- ROW 1: Two-Column Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="1"/>
                <ColumnDefinition Width="200"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT: Programs -->
            <Grid Grid.Column="0" Padding="4,8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Pinned" FontSize="11" Foreground="#88FFFFFF"
                           Margin="12,0,0,4" FontWeight="SemiBold"/>

                <ListView x:Name="PinnedProgramsList" Grid.Row="1"
                          SelectionMode="None" IsItemClickEnabled="True"
                          ItemClick="ProgramItem_Click">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="10" Padding="4,3">
                                <FontIcon Glyph="&#xE756;" FontSize="16" Foreground="#CCFFFFFF"/>
                                <TextBlock Text="{Binding DisplayName}" Foreground="White" FontSize="13"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <!-- Separator -->
                <Border Grid.Row="2" Height="1" Background="#30FFFFFF" Margin="12,6"/>

                <Grid Grid.Row="3">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Text="Recent" FontSize="11" Foreground="#88FFFFFF"
                               Margin="12,0,0,4" FontWeight="SemiBold"/>
                    <ListView x:Name="RecentProgramsList" Grid.Row="1"
                              SelectionMode="None" IsItemClickEnabled="True"
                              ItemClick="ProgramItem_Click">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Spacing="10" Padding="4,3">
                                    <FontIcon Glyph="&#xE756;" FontSize="16" Foreground="#CCFFFFFF"/>
                                    <TextBlock Text="{Binding DisplayName}" Foreground="White" FontSize="13"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </Grid>

            <!-- Vertical Separator -->
            <Border Grid.Column="1" Background="#30FFFFFF"/>

            <!-- RIGHT: System Links -->
            <StackPanel Grid.Column="2" Padding="4,8" Spacing="0">
                <Button x:Name="BtnDocuments" Click="ShellLink_Click" Tag="Documents"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE8A5;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Documents" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>

                <Button x:Name="BtnPictures" Click="ShellLink_Click" Tag="Pictures"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xEB9F;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Pictures" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>

                <Button x:Name="BtnMusic" Click="ShellLink_Click" Tag="Music"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE8D6;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Music" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>

                <Button x:Name="BtnVideos" Click="ShellLink_Click" Tag="Videos"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE714;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Videos" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>

                <Button x:Name="BtnDownloads" Click="ShellLink_Click" Tag="Downloads"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE896;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Downloads" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>

                <!-- Separator -->
                <Border Height="1" Background="#30FFFFFF" Margin="10,6"/>

                <Button x:Name="BtnComputer" Click="ShellLink_Click" Tag="Computer"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE7F8;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Computer" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                    </StackPanel>
                </Button>

                <!-- Control Panel with expandable sub-menu -->
                <Button x:Name="BtnControlPanel" Click="ControlPanel_Click"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE713;" FontSize="14" Foreground="#CCFFFFFF"/>
                            <TextBlock Text="Control Panel" Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                        </StackPanel>
                        <FontIcon Grid.Column="1" x:Name="ControlPanelChevron"
                                  Glyph="&#xE76C;" FontSize="10" Foreground="#88FFFFFF"
                                  VerticalAlignment="Center"/>
                    </Grid>
                </Button>

                <!-- Control Panel Sub-Items (collapsed by default) -->
                <StackPanel x:Name="ControlPanelSubMenu" Visibility="Collapsed" Margin="20,0,0,0">
                    <ListView x:Name="ControlPanelList" SelectionMode="None"
                              IsItemClickEnabled="True" ItemClick="ControlPanelItem_Click"
                              MaxHeight="180">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Spacing="8" Padding="2,2">
                                    <FontIcon Glyph="{Binding Glyph}" FontSize="12" Foreground="#AAFFFFFF"/>
                                    <TextBlock Text="{Binding DisplayName}" Foreground="#DDFFFFFF" FontSize="12"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>

                <!-- Separator -->
                <Border Height="1" Background="#30FFFFFF" Margin="10,6"/>

                <Button x:Name="BtnDevices" Click="ShellLink_Click" Tag="Devices"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE772;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Devices and Printers" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>

                <Button x:Name="BtnDefaultPrograms" Click="ShellLink_Click" Tag="DefaultPrograms"
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                        Background="Transparent" BorderThickness="0" Padding="10,7">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <FontIcon Glyph="&#xE74C;" FontSize="14" Foreground="#CCFFFFFF"/>
                        <TextBlock Text="Default Programs" Foreground="White" FontSize="13"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>

        <!-- ROW 2: Search Box -->
        <Grid Grid.Row="2" Padding="10,6" Background="#20FFFFFF">
            <AutoSuggestBox x:Name="SearchBox" PlaceholderText="Search programs and files..."
                            QueryIcon="Find" TextChanged="SearchBox_TextChanged"
                            QuerySubmitted="SearchBox_QuerySubmitted"/>
        </Grid>

        <!-- ROW 3: Shutdown Bar -->
        <Grid Grid.Row="3" Padding="10,8" Background="#15FFFFFF">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                <Button x:Name="BtnShutdown" Click="Shutdown_Click" Tag="Shutdown"
                        Background="#CC8B0000" Foreground="White" Padding="12,6"
                        CornerRadius="3,0,0,3" BorderThickness="0">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <FontIcon Glyph="&#xE7E8;" FontSize="13" Foreground="White"/>
                        <TextBlock Text="Shut down" FontSize="12"/>
                    </StackPanel>
                </Button>
                <Button x:Name="BtnShutdownMenu" Click="ShutdownMenu_Click"
                        Background="#CC8B0000" Foreground="White" Padding="6,6"
                        CornerRadius="0,3,3,0" BorderThickness="0">
                    <FontIcon Glyph="&#xE70D;" FontSize="10" Foreground="White"/>
                </Button>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
